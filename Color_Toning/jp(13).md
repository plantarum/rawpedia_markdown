<span style="color: #000000; background: none; overflow: hidden; page-break-after: avoid; font-size: 2.0em; font-family: Georgia,Times,serif; margin-top: 1em; margin-bottom: 0.25em; line-height: 1.3; padding: 0; border-bottom: 1px solid #AAAAAA;">カラートーン調整
</span>

## イントロダクション

![](Rt55_color_toning_grids_1_mask_on.png "Rt55_color_toning_grids_1_mask_on.png")
![](Rt55_color_toning_grids_1_mask_off.png "Rt55_color_toning_grids_1_mask_off.png")

　この用語を見て最初に思いつくのは：“カラートン調整”或いは“色のスプリット調整”の定義とは何か？どの分野で使われている用語、といったところでしょうか。実際、ウェブ検索すると：“カラートーン調整とは、白黒イメージを明暗に応じて色付けをするような調整、例えば、ハイライトをイエローに、シャドウをブルーにする、といった解説が多く見つかります。

　コンセプトを拡大解釈すれば、以下の様に定義できます：

- カラートーン調整は、画像に主調色を加えることである。主調色は画像のハイライト領域、シャドウ領域、或いはその両領域で調節することが可能である。
- 調整領域をハイライトとシャドウというように制限せず、輝度全域に拡大する。

　RawTherapeeでは、この2つの原則に合わせるべく2種類のアルゴリズムを用意しました：

- “目標とする色をブレンドする”というアルゴリズム。この場合は、色彩に重点を置いた、*出力される色相”＝“入力された色相”＋（“目標とする色相”－“入力された色相”）xバランス*という様な式を使います。バランスは0から1の値を持つ係数です。インターネットで検索すれば、この種のアルゴリズムは簡単に見つかります。
- “RGBチャンネルを加えたり、引いたりする”アルゴリズム。この場合は、輝度（シャドウ、中間トーン、ハイライト）に応じて、1つのチャンネルを増幅すると同時に他2つのチャンネルを減衰します、例えば、特定された輝度範囲で“R”チャンネルがX％増幅されると、同時に“G”チャンネルと“B”チャンネルはX%減衰します。注意：このアルゴリズムは“チャンネルミキサー”とは違います。ウェブなどで検索する限り、この種のアルゴリズムは見つかりませんでしたが、Photoshopの“カラーバランス”モジュールの特性を調べるうちに、凡そのことが分り、似たような効果をもたらすアルゴリズムを作りました。

　使ってみて言えるのは、カラー画像に対しては、1番目のアルゴリズムを使ったカラートーン調整の方が、結果が良いということです。但し、こう調整したら、こういう結果になるだろうという予測を付けるのは簡単ではありません。また、白黒画像に対してはカラーに比べ効果が良くないと思われます。もちろんこれは比較の話であって、白黒画像の調整結果には満足行かない、ということではありません。このアルゴリズムを実践するため、2つの方式を作りました。どちらがより優れている、ということはありません。方式が2つあることで調整効果の幅が広がると言うことです：

- RGBモード：R、G、B、各チャンネルが上記の前者で説明したアルゴリズムに基づいて作用します。
- L\*a\*b\*モード：“a\*”（レッド/グリーン）と“b\*”（ブルー/イエロー）という2つのカラーコンポーネントが上記の前者で説明したアルゴリズムに基づいて作用します。このモードは選択方式から見ると、予測の付け易さは普通ですが、その代わり期待する効果を得るには創造力が要求されるでしょう。

　2番目のアルゴリズムに関しては“強さ”のスライダーを使った3つの方式を作りました：

- 低い値を使った方式で、調整はPhotoshopの“カラーバランス”に近く、正確なカラートーン調整が可能です。
- 高い値を使ったカラーモードの方式で、ブレンド方式のアルゴリズムと似たような効果が得られます。しかし、独創的な調整は難しいかもしれません。
- 高い値を使った白黒モードの方式で、強い特殊効果が期待できます。

## 異なる方式

### “ブレンド”方式

　“ブレンド”モードには、“a\*”と“b\*”、2つのカラーコンポーネントを使う“L\*a\*b\*モデルでブレンド”と、スライダー或いはカーブを使う2つの“RGB”ブレンド（アルゴリズムは同じ）があります。Labモードはカラーコンポーネントが輝度から切り離されているので、色が輝度に影響することはありませんが、2つのRGBモードは、間接的に輝度に影響を与えます。3種類の方法による効果の違いは、部分的にこの特性で説明されます。

　RGBモードには、スライダーを使う、カーブを使うという2つの方法がありますが、不透明度の調整法はどちらの方法でも1種類（カラーブレンディングマネジメント）だけです。一方、Labモードには4種類の不透明度調整があります。1つは“標準クロマ”で、RGBモードに使われる不透明度調整と似ています。後の3つは特殊効果が高い種類です。

　使われるカーブは特殊なフラットカーブです。

1.  カラーカーブは横軸が輝度を表し、縦軸が目標とする色相です。2本の垂直線が主な効果範囲を示しています。このカーブを次の様に動かすと：
    - 垂直線の位置を変える
    - カーブの形状を変える
    - 目標とする色相を変える


    それぞれ異なった結果になります
2.  不透明度カーブ
    (L\*a\*b\*ブレンドは標準クロマ、RGBカーブの場合は1種類)
    は横軸が輝度、縦軸が不透明度（バランスとも呼ぶ）を表しており、元画像の色相から目標とする色相に組み立てられる様子を示しています。ここで不透明度の値は0から1の間です。値が高いほど、ブレンドは目標とする色相に近く、0の場合は、変化がない状態です。

　彩度の設定は（効果を最大にする）は次の様に行います：

1.  手動で行う方法で、“自動”ボタンのチェックは外します。“しきい値”スライダーと“強さ”のスライダーが使えます。
2.  “自動”ボタンにチェックを入れ、自動で行います。色空間（sRGB、AdobeRGB、Prophotoなど）を考慮しながら、画像のピクセルにとって最良の“しきい値”と“強さ”を自動的に設定します。

#### “"L\*a\*b\*ブレンド”の 特性

##### 特定のクロマ

　これを選択すると、フラットカーブが標準的なカーブのグラフに変わります。2つのカラーコンポーネント、“a\*”と“b\*”（Lab）が、同じ増幅率で変化します。カーブを対角線より下にすると、不透明度の値がマイナスになり、予想も付かない効果になることがよくあります。

##### 特定のa\*とb\*

　これを選択すると、フラットカーブは、2つの標準的グラフに変わります。2つのカラーコンポーネント、“a\*”と“b\*”（Lab）は、2つのカーブで独立した作用をします。初めのカーブは、“a\*”、レッド/グリーン、だけに作用し、2番目のカーブは“b\*”、ブルー/イエロー、だけに作用します。カーブを対角線より下にすると、不透明度の値がマイナスになり、予想も付かない効果になることがよくあります。

##### 特定のクロマ2色

　“特定のクロマ”同様、フラットカーブは標準的カーブで置き換えられます。2つのカラーコンポーネント、“a\*”と“b\*”（Lab）が、同じ増幅率で変化します。カーブを対角線より下にすると、不透明度の値がマイナスになり、予想も付かない効果になることがよくあります。

　“特定のクロマ”との違いは、カラーカーブの使われ方です。“特定のクロマ”の場合は、カーブの変化が色相全体に影響しますが、“特定のクロマ2色”では、L\*a\*b\*ブレンドを選択した際にフラットカーブの2本の垂直線によって設定された2つの色相だけに効果が集中します。

#### RGBスライダーの特性

　使い勝手を模索しているうちに、Lightroomに近い機能になったモードもあります（後述する“2色の彩度”）

　2つのスライダーで好みのカラートーン調整を行います。1番目のスライダーはハイライト部分での調整、2番目はシャドウ部分に使います。両スライダーとも、目標とする色相と強さが設定できます。両法ともゼロに設定すると画像に変化は起こりません。

　“バランス”と書かれたスライダーは、明るさの中心をどこに置くか決めるものです。左へ動かす（マイナス値）と、ハイライト部分での効果の方が強くなります。逆はシャドウ部分での効果が強まります。

### “色を加える”方式

#### シャドウ/中間トーン/ハイライトでバランス

　この方法は、モジュールの働きとレンダリングの観点から、Photoshopの“カラーバランス”と非常によく似ています。

　ハイライト、中間トーン、シャドウで別々な調整が行えます。

　それぞれのスライダーは、色とその色の補色、レッドとシアン、グリーンとマジェンタ、ブルーとイエローに作用します。

“強さ”のスライダーは、システムの感度を決めるものです：

1.  50以下の低い数値を使えば、このツールで画像のカラーバランスを調整出来ます、つまり全体的な色のブレンドを変えることが出来るので、一般的な色の補正が行えます。
2.  マイナス値を使えば、カラートーン調整として使えます。
3.  高い値は、白黒-補足で説明されているツールも一緒に使うことで、白黒画像のカラートーン調整が叶います（プログラム内部のアルゴリズムはカラーと白黒では異なります）。

　“明度を維持”を有効にすると、カラー調整を行った時に、画像の明度が変わらないようにしますので、画像のトーンバランスを維持できます。

#### 2色の彩度

　この方法は、モジュールの働きやレンダリングの観点で、ACRやLightrommに似ています。

　このツールは白黒-補足にある機能と併用することも出来ますが、カラートーン調整が主目的です。

　2つのスライダーで好みのカラートーン調整を行います。1番目のスライダーはハイライト部分での調整、2番目はシャドウ部分に使います。両スライダーとも、目標とする色相と強さが設定できます。両法ともゼロに設定すると画像に変化は起こりません。

　“バランス”と書かれたスライダーは、明るさの中心をどこに置くか決めるものです。左へ動かす（マイナス値）と、ハイライト部分での効果の方が強くなります。逆はシャドウ部分での効果が強まります。

　“強さ”のスライダーは、システムの感度を調節するものです。

　“明度を維持”を有効にすると、カラー調整を行った時に、画像の明度が変わらないようにしますので、画像のトーンバランスを維持できます。

## 白黒

　カラートーン調整の機能、特に“シャドウ/中間トーン/ハイライトでカラーバランス”は、白黒の機能、特に“[輝度イコライザ](Black-and-White_addon/jp#白黒-補足 "wikilink")”と併用することで、白黒画像に独創的な効果をもたらすでしょう。

## フィルムシミュレーション

- カラーの[フィルムシミュレーションに](Film_Simulation/jp "wikilink")関しては、カラートーン調整の機能は全て直接的に使えます。
- 白黒のフィルムシミュレーションの場合は、“白黒”機能を有効しておく必要があります。その上で、カラートーン調整の機能を使います。白黒の“彩度低減”が最もニュートラルな方式なので、白黒機能に備わった特殊効果のツールを使わなくとも、全てのカラートーン調整機能を使って特殊効果を出せます。