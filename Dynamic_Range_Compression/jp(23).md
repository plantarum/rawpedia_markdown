<span style="color: #000000; background: none; overflow: hidden; page-break-after: avoid; font-size: 2.0em; font-family: Georgia,Times,serif; margin-top: 1em; margin-bottom: 0.25em; line-height: 1.3; padding: 0; border-bottom: 1px solid #AAAAAA;">ダイナミックレンジの圧縮</span>

## イントロダクション

　ダイナミックレンジは幅広く使われる専門用語で、計測されるシグナルの最小値と最大値の範囲を意味します。写真撮影で扱う様々な必要事項の中にも、人間の目の知覚という独自の
\[<https://en.wikipedia.org/wiki/Dynamic_range#Human_perception>　ダイナミックレンジ\]（夜空では微かに輝く星でも見ることが出来、日中は明るい空を見ることが出来ますが、同時にそれらを見ることは出来ません）があり、貴方が使用しているモニターにも（人間の目の知覚より遥かに狭いですが）、カメラの撮像センサーやそこから取り込んだシグナルを処理する電子パーツにもダイナミックレンジがあります。
“ダイナミックレンジの圧縮”機能は、撮影された画像のダイナミックレンジを圧縮・再配分する機能です。

　画像のダイナミックレンジとは、画像の最も明るい部分から最も暗い部分の範囲のことです。濃霧に包まれた野外の画像を想像して下さい。最も明るい部分と最も暗い部分の差は極端に大きくはないでしょう。これをダイナミックレンジが狭い画像と言います。一方、晴れた日の屋外が映っている部屋の中の画像を想像して下さい。日が当たっている空の明るさは、暗い部屋の隅どころか、電灯のついた部屋よりかなり明るいはずです、これをダイナミックレンジが広い画像と言います。

　撮影された画像のダイナミックレンジは、それを見るためのデバイス（モニター、ラップトップPC、スマートフォンなど）のダイナミックレンジより広いのが普通です。そのため画像をデバイスで適切に表示するためには、一般的に2通りの処理を行います：一方は、撮影画像の中で、デバイスで再生可能なダイナミックレンジを逸脱している部分を削除します（屋外の空の明る過ぎる部分を削除する代わりに、部屋の中の映りを適切にする、または、屋外の空の明るさを維持する代わりに部屋の中を暗い映りにする）、もう一方は、ダイナミックレンジの範囲を圧縮し、暗い部分も明るい部分も適度に映るようにします、以下説明するこの機能は後者の方です。

　“ダイナミックレンジの圧縮”機能は、画像のハイライト部分を軽減し、シャドウ部分を持ち上げて、画像のダイナミックレンジを圧縮する機能です。[Gradient
Domain High Dynamic Range
Compression](http://www.cs.huji.ac.il/~danix/hdr/)という研究論文、他のソフトでは単純に“Fattal”と呼ばれる輝度のHDR圧縮法をベースにして作りました。
この機能はRGB色空間で作用し、実際の処理は[ノイズ低減](Noise_Reduction/jp "wikilink")
と
[霞除去の](Haze_Removal/jp "wikilink")前に行われますが、[露光補正などのトーンカーブの](Exposure/jp "wikilink")調整前になります。

　ダイナミックレンジを他の機能を使って圧縮する方法もあります。最も単純なのが、[露光補正](Exposure/jp "wikilink")機能でコントラストの値をマイナスに設定する（先に示したダイナミックレンジの再配分とは異なり）ことです。しかし、殆どの場合、これだけでは画像の印象が眠くなり、つまらないものになります。そこでトーンカーブを使って更に補正を加えますが、このダイナミックレンジの圧縮機能は、そうした一連の処理に特化した様な機能です。

## 利用法

　撮影した画像のダイナミックレンジが広すぎて、貴方のモニターでは美しく映らない場合、つまり画像の暗い部分と明るい部分の差（コントラスト）が大きすぎて、それら部分ではディテールが少ないという状態の時、この機能を使います。

　Panorama
Stitcherなどのアプリを思い出して下さい。この機能の効果は編集中の画像のダイナミックレンジ（及びヒストグラム）次第です。一連の画像をスティッチング加工する場合、各画像には隣り合う画像と重なる部分が存在し、たとえ各画像に同じ編集パラメータを適用しても、最終的な効果は一致しません-つまり隣り合った画像の間には急激に明るさが変わる部分があるからです。従って、このダイナミックレンジの圧縮機能は、元画像には使わない方がいいでしょう。一連の画像の間で一貫したダイナミックレンジの圧縮を行う場合は、この機能の代わりにトーンカーブを使います。但し、この機能をパノラマ画像のスティッチングに使うことは出来ます。

## インターフェイス

### 量

　圧縮する強さを調整します。設定値を低くすれば、それだけ少ない圧縮に留めます。デフォルトで設定されている20が適度な調整開始点と考えます。

### 細部

　このパラメータで維持したい詳細部分の量を設定します。プラスの値でトーンマッピング処理により失われた詳細を回復します。技術的に言えばこの設定値は、論文の中のαにつながるもので、部分的なコントラストの強さに応じて減衰を行います。デフォルトでは詳細の回復を行わない0が設定されていますが、通常は若干のプラス値が望ましいでしょう。

### アンカー

　ダイナミックレンジの圧縮をシャドウ部分、或いはハイライト部分に偏らせて行うスライダーです。設定値を低くすればシャドウ部分に偏り、高くすればハイライト部分に偏ります。デフォルトは偏りがない０の設定になっています。技術的に言えば、この設定値は論文の中のβにつながるものです。