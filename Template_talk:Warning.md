This seems to work but the documentation part needs a rebuilding.